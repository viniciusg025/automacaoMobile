"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.listFiles = listFiles;
exports.pullFile = pullFile;
/**
 * Lists files at a specified path on the device
 */
async function listFiles(domainType, domainIdentifier, opts = {}) {
    const subcommandOptions = ['--domain-type', domainType, '--domain-identifier', domainIdentifier];
    if (opts.username) {
        subcommandOptions.push('--username', opts.username);
    }
    if (opts.subdirectory) {
        subcommandOptions.push('--subdirectory', opts.subdirectory);
    }
    const { stdout } = await this.execute(['device', 'info', 'files'], {
        subcommandOptions,
    });
    return JSON.parse(stdout).result.files.map(({ name }) => name);
}
/**
 * Pulls a file from the specified path on the device to a local file system
 */
async function pullFile(from, to, opts) {
    const subcommandOptions = [
        '--domain-type',
        opts.domainType,
        '--domain-identifier',
        opts.domainIdentifier,
        '--source',
        from,
        '--destination',
        to,
    ];
    if (opts.username) {
        subcommandOptions.push('--user', opts.username);
    }
    await this.execute(['device', 'copy', 'from'], {
        subcommandOptions,
        timeout: opts.timeout ?? 120000,
        asJson: false,
    });
    return to;
}
//# sourceMappingURL=copy.js.map